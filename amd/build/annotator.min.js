define(["jquery","jqueryui","core/config","core/str","core/notification"],function(a,b,c,d,e){"use strict";function f(){var b=a.Deferred(),d={objectid:a("#block_annotations-addform-objectid").val(),objecttable:a("#block_annotations-addform-objecttable").val(),courseid:a("#block_annotations-addform-courseid").val(),sesskey:c.sesskey},e={type:"POST",dataType:"json",data:d};return a.ajax(k,e).done(function(){b.resolve()}),b}function g(a,b,c,d){var e="";"undefined"!=typeof d&&null!==d&&(e='data-courseid="'+d+'"'),a.append('<div class="annotations"><span data-objecttype="'+b+'" data-objectid="'+c+'" '+e+' class="btn">'+l+"</span></div>")}function h(){a(".annotations span.btn").click(function(){a("#block_annotations-addform-objectid").val(a(this).attr("data-objectid")),a("#block_annotations-addform-objecttable").val(a(this).attr("data-objecttype")),j.dialog("open")})}function i(b){p=b,console.log(b),a("body").append('<div id="block_annotations-addform" title="Create annotation"><form><fieldset><input id="block_annotations-addform-objectid" type="hidden" name="objectid" value=""/><input id="block_annotations-addform-objecttable" type="hidden" name="objecttable" value=""/><input id="block_annotations-addform-courseid" type="hidden" name="courseid" value=""/><label for="annotation">Annotation</label><textarea name="annotation" id="annotation-textarea" class="text ui-widget-content ui-corner-all" style="width: 300px; height: 150px;"></textarea><input type="submit" tabindex="-1" style="position:absolute; top:-1000px"></fieldset></form></div>'),j=a("#block_annotations-addform").dialog({autoOpen:!1,height:400,width:350,modal:!0,buttons:[{text:m,click:f},{text:n,click:function(){j.dialog("close")}}],close:function(){j.find("form")[0].reset()}})}var j,k=c.wwwroot+"/blocks/annotations/annotate.php",l="",m="",n="",o="",p="";return d.get_string("view","block_annotations").done(function(a){l=a}).fail(e.exception),d.get_string("save").done(function(a){m=a}).fail(m="save"),d.get_string("cancel").done(function(a){n=a}).fail(n="cancel"),d.get_string("close").done(function(a){o=a}).fail(o="close"),{add:g,init:i,run:h}});